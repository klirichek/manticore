.. raw:: html

   <div class="navheader">

A.13. Version 2.2.1-beta, 13 nov 2013
`Prev <rel222.html>`__ 
Appendix A. Sphinx revision history
 `Next <rel219.html>`__

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="sect1">

.. raw:: html

   <div class="titlepage">

.. raw:: html

   <div>

.. raw:: html

   <div>

.. rubric:: A.13. Version 2.2.1-beta, 13 nov 2013
   :name: a.13.version-2.2.1-beta-13-nov-2013
   :class: title

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   </div>

.. rubric:: Major new features
   :name: major-new-features

.. raw:: html

   <div class="itemizedlist">

-  added `ALTER TABLE <sphinxql-attach.html>`__ that can add attributes
   to disk and RT indexes on the fly
-  added ATTACH support for non-empty RT target indexes
-  added Chinese segmentation with `RLP <conf-morphology.html>`__
   (Rosette Linguistics platform) support
-  added English, German `lemmatization <conf-morphology.html>`__
   support
-  added `HAVING <sphinxql-select.html>`__ support to SELECT statement,
   filtering on aggregate values is now possible
-  added `N-best GROUP BY <sphinxql-select.html>`__ extension to return
   more than 1 row per group
-  added RT index support for
   `index\_field\_lengths=1 <conf-index-field-lengths.html>`__, bitfield
   attributes, and multiforms
-  added `CSV <xsvpipe.html>`__, `TSV <xsvpipe.html>`__ data sources
-  added full `JSON <conf-sql-attr-json.html>`__ attributes support,
   arbitrary JSON documents (with subobjects etc) can now be stored
-  added in-place JSON updates for scalar values
-  added index `type=template <conf-index-type.html>`__ directive
   (allows CALL KEYWORDS, CALL SNIPPETS)
-  added `ondisk\_attrs <conf-ondisk-attrs.html>`__,
   `ondisk\_attrs\_default <conf-ondisk-attrs-default.html>`__
   directives that keep attributes on disk
-  added table functions mechanism, and
   `REMOVE\_REPEATS() <sphinxql-select.html>`__ table function
-  added support for arbitrary expressions in WHERE for DELETE queries

.. raw:: html

   </div>

.. rubric:: Ranking related features
   :name: ranking-related-features

.. raw:: html

   <div class="itemizedlist">

-  added OPTION `local\_df=1 <sphinxql-select.html>`__, an option to
   aggregate IDFs over local indexes (shards)
-  added `UDF <sphinx-udfs.html>`__ XXX\_reinit() method to reload UDFs
   with ``workers=prefork``
-  added comma-separated syntax to
   `OPTION <sphinxql-select.html>`__\ `` idf``, ``tfidf_unnormalized``
   and ``tfidf_normalized`` flags
-  added ``lccs``, ``wlccs``, ``exact_order``, ``min_gaps``, and
   ``atc ``\ `ranking factors <field-factors.html>`__
-  added ``sphinx_get_XXX_factors()``, a faster interface to access
   `PACKEDFACTORS() <misc-functions.html>`__ in UDFs
-  added support for `exact\_hit <field-factors.html>`__,
   `exact\_order <field-factors.html>`__ field factors when using more
   than 32 fields (exact\_hit, exact\_order)

.. raw:: html

   </div>

.. rubric:: Instrumentation features
   :name: instrumentation-features

.. raw:: html

   <div class="itemizedlist">

-  added `DESCRIBE <sphinxql-describe.html>`__ and
   `–dumpheader <ref-indextool.html>`__ support for tokencount
   attributes (generated by index\_field\_lengths=1 directive)
-  added RT index query profile, percentages, totals to `SHOW
   PROFILE <sphinxql-show-profile.html>`__
-  added ``predicted_time``, ``dist_predicted_time``, ``fetched_docs``,
   ``fetched_hits`` counters to `SHOW META <sphinxql-show-meta.html>`__
-  added ``total_tokens`` and ``disk_bytes`` counters to `SHOW INDEX
   STATUS <sphinxql-show-index-status.html>`__

.. raw:: html

   </div>

.. rubric:: General features
   :name: general-features

.. raw:: html

   <div class="itemizedlist">

-  added `ALL() <misc-functions.html#expr-func-all>`__,
   `ANY() <misc-functions.html#expr-func-any>`__ and
   `INDEXOF() <misc-functions.html#expr-func-indexof>`__ functions for
   JSON subarrays
-  added
   `MIN\_TOP\_WEIGHT() <misc-functions.html#expr-func-min-top-weight>`__,
   `MIN\_TOP\_SORTVAL() <misc-functions.html#expr-func-min-top-sortval>`__
   functions
-  added `TOP() <factor-aggr-functions.html>`__ aggregate function to
   expression ranker
-  added a check for duplicated tail hit positions in `indextool
   –check <ref-indextool.html>`__
-  added `compact\_in <sphinxql-log-format.html>`__ option to
   `query\_log\_format=sphinxql <conf-query-log-format.html>`__
-  added distance units and calculation method options to
   `GEODIST() <misc-functions.html#expr-func-geodist>`__ function,
   optimized it a lot
-  added embedded stopwords/exceptions/wordforms to ``--dumpheader``
-  added `indexer –nohup <ref-indexer.html>`__ and `indextool
   –rotate <ref-indextool.html>`__ switches to check index files before
   rotating them
-  added scientific notation support for JSON attributes (as per `RFC
   4627 <http://www.ietf.org/rfc/rfc4627.txt>`__)
-  added several SphinxQL statements to fix MySQL Workbench connection
   issues (LIKE for session variables, etc.)
-  added `shutdown\_timeout <conf-shutdown-timeout.html>`__ directive to
   ``searchd`` config section
-  added signed values support for
   `INTEGER() <type-conversion-functions.html#expr-func-integer>`__ and
   `UINT() <numeric-functions.html#expr-func-uint>`__ function
-  added snippet generation options to
   `SNIPPET() <sphinxql-select.html>`__ function
-  added string filter support in distributed queries, SphinxAPI,
   SphinxQL query log
-  added support for mixed distributed and local index queries (SELECT
   \* FROM dist1,dist2,local3), and ``index_weights`` option for that
   case

.. raw:: html

   </div>

.. rubric:: Optimizations, behavior changes, and removals
   :name: optimizations-behavior-changes-and-removals

.. raw:: html

   <div class="itemizedlist">

-  optimized JSON attributes access (1.12x to 2.0x+ total query speedup
   depending on the JSON data)
-  optimized SELECT (1.02x to 3.5x speedup, depending on index schema
   size)
-  optimized `UPDATE <sphinxql-update.html>`__ (up to 3x faster on big
   updates)
-  optimized away internal threads table mutex contention with
   ``workers=threads`` and 1000s of threads
-  changed [emptyword -foo] query behavior in cases when emptyword is a
   stopword or an overshort word, made such queries computable rather
   than erroneous
-  changed post-morphology `wordforms <conf-wordforms.html>`__ behavior,
   now it works as ``'if ( stem(token)==stem(abc) ) emit(def)'``
-  changed the `config defaults <sphinx-deprecations-defaults.html>`__
   to ``id64``, ``dict=keywords``, ``charset_type=utf-8``,
   ``enable_star=1``, ``workers=threads``, ``mem_limit=128M``,
   ``rt_mem_limit=128M``
-  changed the default SphinxAPI matching mode to
   `SPH\_MATCH\_EXTENDED2 <matching-modes.html>`__
-  disallowed dashes in index names in API requests (just like in
   SphinxQL)
-  removed legacy ``xmlpipe`` data source v1, ``compat_sphinxql_magics``
   directive, ``SetWeights()`` SphinxAPI call, and SPH\_SORT\_CUSTOM
   SphinxAPI mode

.. raw:: html

   </div>

.. rubric:: Bug fixes
   :name: bug-fixes

.. raw:: html

   <div class="itemizedlist">

-  fixed `#1734 <http://sphinxsearch.com/bugs/view.php?id=1734>`__,
   unquoted literal in json subscript could cause a crash, returns
   ‘unknown column’ now.
-  fixed `#1683 <http://sphinxsearch.com/bugs/view.php?id=1683>`__,
   under certain conditions `stopwords <conf-stopwords.html>`__ were not
   taken into account in RT indexes
-  fixed `#1648 <http://sphinxsearch.com/bugs/view.php?id=1648>`__,
   #1644, when using AOT lemmas with snippet generation, not all the
   forms got highlighted
-  fixed `#1549 <http://sphinxsearch.com/bugs/view.php?id=1549>`__,
   `OPTION <sphinxql-select.html>`__\ ``idf=tfidf_normalized`` was
   ignored for distributed queries
-  fixed that `ORDER BY RAND() <sphinxql-select.html>`__ was not
   affected by ``index_weights``
-  fixed that float updates with integer values in SphinxQL mistakenly
   set the float to 0
-  fixed that ``predicted_time`` was not accumulated with
   `dist\_threads <conf-dist-threads.html>`__
-  fixed `GROUP\_CONCAT <sphinxql-select.html>`__ result length limit
   (was implicitly limited by 1024 bytes)
-  fixed agent query distribution in HA mirroring
-  fixed duplicates check for `quorum
   operator <extended-syntax.html>`__, it works ok now for expanded
   keywords
-  fixed off-by-1 query positions of words in indexes with wordforms and
   `blended characters <extended-syntax.html>`__
-  fixed wrong ``lcs`` and `min\_best\_span\_pos <field-factors.html>`__
   ranking factor values when any expansion
   (`expand\_keywords <conf-expand-keywords.html>`__ or lemmatize)
   occurred
-  fixed a crash while creating indexes with
   `sql\_joined\_field <conf-sql-joined-field.html>`__

.. raw:: html

   </div>

.. raw:: html

   </div>

.. raw:: html

   <div class="navfooter">

--------------

+------------------------------------------+---------------------------+---------------------------------------------+
| `Prev <rel222.html>`__                   | `Up <changelog.html>`__   |  `Next <rel219.html>`__                     |
+------------------------------------------+---------------------------+---------------------------------------------+
| A.12. Version 2.2.2-beta, 11 feb 2014    | `Home <index.html>`__     |  A.14. Version 2.1.9-release, 03 jul 2014   |
+------------------------------------------+---------------------------+---------------------------------------------+

.. raw:: html

   </div>
